"use strict";(self.webpackChunkgame=self.webpackChunkgame||[]).push([[515],{1803:function(t,e,i){i.r(e),i.d(e,{default:function(){return ee}});var s=i(6440);var a=i(6008);const l={class:"getting-started-page"},n={class:"getting-started-content"};var o=i(1040),r=i(1254);const c={class:"trade"},d={class:"trade-info PB-20"},m={class:"trade-top"},h={class:"trade-info__title MB-5"},p={class:"trade-item"},u={class:"trade-item__top flex-row-between"},g={class:"flex-row-start align-center pointer"},w={class:"trade-item__top-icon MR-10"},k={class:"trade-item__top-name text-overflow__1"},f={key:0},y=["disabled"],_={class:"PL-30 PR-30 MT-5"},v={class:"flex-1"},C={class:"token-list__item-title"},b=(0,s._)("div",{class:"flex-row-start"},null,-1),L={class:"flex-row-start text-white"},T={class:"flex-row-start"},x={class:"buy-item flex-row-start align-center MR-10 MB-10",style:{width:"100%"}},z={class:"flex-row-start"},A={class:"buy-item flex-row-start align-center MR-10 MB-10",style:{width:"100%"}},M={class:"flex-row-start"},S={class:"buy-item flex-row-start align-center MR-10 MB-10",style:{width:"100%"}};var D=i(5362),W=i(936),N=i(2762),U=i(8709),P=i(9011),H=i(6120),R=i(9239),B=i(5546),O=i(1279),$=i(9657),I=i(570),J=i(9756),Z=i(6494),j=i(2811);const{t:q}=Z.default.global;var V={data(){return{t:q,checkLowerCase:W.YG,utils:O,lockContract:"",gotPrice:W.ph,getLogo:W.R7,getBit:W.qD,callTime:0,payableAmount:void 0,isLogin:!1,lockType:0,releaseAmount:0,releaseDays:0,lockDay:0,inputTimeout:null,loginTimeout:null,isRefreshing:!1,swapLoading:!1,approveLoading:!1,progress:1,buyCase:"20",releaseList:["20","40","60"],gWeiList:[3,6,9,12],hasApprove:!1,type:"",item1:{},item2:{}}},components:{Tokens:N.Z,History:H.Z,RpcList:U.Z,Setting:P.Z},computed:{...(0,J.Se)(["currentNetwork","currentConfig","accountChange","connectState"]),amountOutMin(){if(!this.item2.price)return $.O$.from(0);let t=I.vz(this.item2.price.toString(),this.item2.decimals),e=I.vz(this.item2.price.toString(),this.item2.decimals),i=I.vz(this.progress.toString(),this.item2.decimals),s=I.vz("100",this.item2.decimals);return e.sub(t.mul(i).div(s)).toString()}},activated(){let t=localStorage.getItem("progress");this.progress=t?JSON.parse(t):1,this.isRefreshing=!0,this.lockContract=this.currentNetwork.lockContract,this.CallContract=new D.Z.Call({blockchain:this.currentNetwork.chains,type:"lock",address:this.lockContract}),this.CallContract.getParams("checkTxPrice").then((t=>{this.payableAmount=t})),this.handleAccount()},deactivated(){this.isRefreshing=!1,clearTimeout(this.callTime)},watch:{accountChange:{handler(t,e){this.handleAccount()},deep:!0},"currentNetwork.ChainID":{immediate:!0,handler(){const{Token:t}=this.currentNetwork,e=t[0];this.item1={...this.item1,...e}}}},mounted(){this.$watch("$route.params.key",(t=>{this.loginCallBack()}))},methods:{...(0,J.nv)(["setConnectDialog"]),handleAccount(){let t=this.getAccount();this.hasApprove=!1,this.pathHas=[],this.item1.price="",t?(this.isLogin=!0,this.loginCallBack()):this.isLogin=!1},async price1Change(t,e=!1){if(clearTimeout(this.inputTimeout),!this.getPrices(t))return;this.inputTimeout=setTimeout((async()=>{await this.checkApprove(),this.setRelease(this.buyCase)}),350)},setRelease(t){this.buyCase=t,"div"!=t&&(this.releaseAmount=I.bM(I.vz(this.item1.price,this.item1.decimals).mul(t).div(100),this.item1.decimals))},getShortAddress(t){return t.substr(0,6)+"..."+t.substr(-4)},getPrices(t){if(void 0===this[t].price||""==this[t].price.trim())return this[t].price="",!1;let e=this[t].price.toString();const i=I.vz("0",18);let s=I.vz(e,this[t].decimals);return!s.lte(i)&&s},getAmount(){var t=this.item1;return""==t.price||!t.balance||(!t.balance.gte||t.balance.gte(I.vz(t.price,t.decimals)))},getAccount(){let t=window.wallet.getByAccount();return t?.address},openSetting(){this.$refs.setting.open()},openRpcList(){this.$refs.rpcList.open()},refreshPage(t){this.type="item2",this.$refs.tokens.fastImport(t.address,!1)},addTokenHandler(){const{symbol:t,address:e}=this.item2;window.wallet.addTokenToMeta(e,t,(0,W.R7)(e))},progressChange(){localStorage.setItem("progress",this.progress)},tokenUpdate({address:t,name:e,symbol:i}){this.item1.address==t&&(this.item1.name=e,this.item1.symbol=i),this.isLogin&&this.loginCallBack()},async tokenChange(t,e){"item1"==(e=e||this.type)?this.item2.address==t.address&&(this.item2=JSON.parse(JSON.stringify(this.item1))):this.item1.address==t.address&&this.item1.address==t.address&&(this.item1=JSON.parse(JSON.stringify(this.item2))),t.price="0",this[e]=t,this.isLogin&&this.loginCallBack()},maxHandler(){let t=(0,j.IU)(this.item1.balance);if(this.checkLowerCase(this.item1.address,window.wallet.getWrappedAddress())){const e=I.vz("0.001",this.item1.decimals);t=t.sub(e)}this.item1.price=(0,W.qD)(I.bM(t,this.item1.decimals)),this.price1Change("item1",!0)},async approveHandler(){this.approveLoading=!0;try{let t,e=this.getAccount(),i=await window.wallet.getByToken(this.item1.address,e),s=$.O$.from("115792089237316195423570985008687907853269984665640564039457584007913129639935",0);try{t=await i.token.approve(this.lockContract,s),await t.wait(),(0,B.bM)({type:q("success"),title:q("success"),message:q("approve")+q("success")}),await this.swapHandler()}catch(e){this.$refs.history.pushItem({item1:JSON.parse(JSON.stringify(this.item1)),action:"approve",tx:JSON.parse(JSON.stringify(t)),status:0}),(0,B.bM)({title:"tips approve",message:e.message,type:"error",duration:3e3})}this.checkApprove()}catch(t){(0,W.CR)(t)}this.approveLoading=!1},async swapHandler(){this.swapLoading=!0;let t,e=[],i=this.item1.address,s=I.vz(this.item1.price.toString(),this.item1.decimals),a=0==this.lockType,l=this.lockDay,n=0,o=0,r=this.payableAmount;a&&(o=I.vz(this.releaseAmount.toString(),this.item1.decimals),n=this.releaseDays),e=[i,s,l,a,o,n];try{t=await this.CallContract.payParams("deployLock",e,r);await t.wait();(0,B.bM)({type:q("success"),title:q("success"),message:q("exchange")+q("success")}),this.$router.push({path:"/lock/scan",query:{inputCurrency:this.item1.address}})}catch(t){}this.swapLoading=!1},async checkApprove(){if(!this.isLogin)return;let t=this.getAccount(),e=!0;if(this.checkLowerCase(this.item1.address,window.wallet.getWrappedAddress()))return void(this.hasApprove=!0);let i=await window.wallet.getByToken(this.item1.address,t);(await i.token.allowance(t,this.lockContract)).lt(this.item1.balance)&&(e=!1),this.hasApprove!=e&&(this.hasApprove=e)},async loginCallBack(t=!0){clearTimeout(this.loginTimeout);this.loginTimeout=setTimeout((async()=>{this.item1.loading=t,this.item2.loading=t,await this.getItemBalance(this.item1.address,"item1")}),500)},async getItemBalance(t,e){if(!t)return!1;if(!this.isLogin)return!1;let{name:i,symbol:s,decimals:a,balance:l}=await window.wallet.getByToken(t);return this[e].balance=l,this[e].decimals=a,this[e].name=i,this[e].symbol=s,this[e].loading=!1,{balance:l,decimals:a}},copyHandler(t){(0,R.Z)(t),(0,B.bM)({type:q("success"),title:q("success"),message:q("copy")+q("success")})},toggleGwei(t){this.gWei=t,window.wallet.setGasGwei(t)},openHistory(){this.$refs.history.open()},openTokensDialog(t){this.type=t,this.$refs.tokens.open([this.item1.address,this.item2.address])},swapSubmit(){this.currentConfig?.professional?this.swapHandler():this.$refs.swapConfirm.open(this.item1,this.item2)},loginFn(){this.setConnectDialog(!0)}}},F=i(7650);var Y=(0,F.Z)(V,[["render",function(t,e,i,a,l,n){const D=(0,s.up)("Histogram"),W=(0,s.up)("el-icon"),N=(0,s.up)("Operation"),U=(0,s.up)("Link"),P=(0,s.up)("Clock"),H=(0,s.up)("ArrowDown"),R=(0,s.up)("CopyDocument"),B=(0,s.up)("Loading"),O=(0,s.up)("el-tag"),$=(0,s.up)("QuestionFilled"),I=(0,s.up)("el-tooltip"),J=(0,s.up)("el-radio"),Z=(0,s.up)("el-radio-group"),j=(0,s.up)("el-button"),q=(0,s.up)("Tokens"),V=(0,s.up)("SwapConfirm"),F=(0,s.up)("History"),Y=(0,s.up)("RpcList"),G=(0,s.up)("Setting"),E=(0,s.up)("pkm"),Q=(0,s.Q2)("lazy");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",c,[(0,s._)("div",d,[(0,s._)("div",m,[(0,s.Wm)(W,{size:30,class:"trade-top__icon",onClick:e[0]||(e[0]=e=>t.chartShow=!t.chartShow)},{default:(0,s.w5)((()=>[(0,s.Wm)(D)])),_:1}),(0,s._)("div",h,(0,o.zw)(l.t("lock.create")),1),(0,s.Wm)(W,{size:30,class:"trade-top__icon operation pointer",onClick:e[1]||(e[1]=e=>t.$refs.setting.open())},{default:(0,s.w5)((()=>[(0,s.Wm)(N)])),_:1}),(0,s.Wm)(W,{size:30,class:"trade-top__icon rpc pointer",onClick:e[2]||(e[2]=e=>t.$refs.rpcList.open())},{default:(0,s.w5)((()=>[(0,s.Wm)(U)])),_:1}),l.isLogin?((0,s.wg)(),(0,s.j4)(W,{key:0,size:30,class:"trade-top__icon right pointer",onClick:e[3]||(e[3]=e=>t.$refs.history.open())},{default:(0,s.w5)((()=>[(0,s.Wm)(P)])),_:1})):(0,s.kq)("",!0)]),(0,s._)("div",p,[(0,s._)("div",u,[(0,s._)("div",g,[(0,s._)("div",{class:"flex-row-start align-center",onClick:e[4]||(e[4]=t=>n.openTokensDialog("item1"))},[(0,s.wy)((0,s._)("img",w,null,512),[[Q,l.getLogo(l.item1.address)]]),(0,s._)("div",k,(0,o.zw)(l.item1.symbol),1),(0,s.Wm)(W,{class:"ML-5"},{default:(0,s.w5)((()=>[(0,s.Wm)(H)])),_:1})]),(0,s.Wm)(W,{class:"ML-5",onClick:e[5]||(e[5]=t=>n.copyHandler(l.item1.address))},{default:(0,s.w5)((()=>[(0,s.Wm)(R)])),_:1})]),l.isLogin?((0,s.wg)(),(0,s.iD)("div",f,[l.item1.loading?((0,s.wg)(),(0,s.j4)(W,{key:0,class:"is-loading"},{default:(0,s.w5)((()=>[(0,s.Wm)(B)])),_:1})):l.item1.balance?((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s.Uk)((0,o.zw)(l.t("balance"))+"："+(0,o.zw)(l.gotPrice(l.utils.formatUnits(l.item1.balance,l.item1.decimals))),1)],64)):(0,s.kq)("",!0)])):(0,s.kq)("",!0)]),(0,s._)("div",{class:(0,o.C_)(["trade-item__input MT-10 flex-row-start align-center",{"is-disabled":!l.isLogin}])},[(0,s.wy)((0,s._)("input",{disabled:!l.isLogin||l.approveLoading,class:"text-right flex-1",onInput:e[6]||(e[6]=t=>n.price1Change("item1",!0)),"onUpdate:modelValue":e[7]||(e[7]=t=>l.item1.price=t),placeholder:"0.00"},null,40,y),[[r.nr,l.item1.price]]),l.isLogin?((0,s.wg)(),(0,s.j4)(O,{key:0,class:"ML-10 ml-2 pointer",effect:"light",onClick:n.maxHandler,type:"warning",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("MAX")])),_:1},8,["onClick"])):(0,s.kq)("",!0)],2)]),(0,s._)("div",_,[(0,s._)("div",v,[(0,s._)("div",C,[b,(0,s._)("div",L,[(0,s.Wm)(Z,{modelValue:l.lockType,"onUpdate:modelValue":e[8]||(e[8]=t=>l.lockType=t)},{default:(0,s.w5)((()=>[(0,s.Wm)(J,{label:0},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("lock.line"))+" ",1),(0,s.Wm)(I,{class:"box-item",effect:"light",content:t.$t("tips.lockLine"),placement:"bottom"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{class:"ML-5"},{default:(0,s.w5)((()=>[(0,s.Wm)($)])),_:1})])),_:1},8,["content"])])),_:1}),(0,s.Wm)(J,{label:1},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("lock.normal"))+" ",1),(0,s.Wm)(I,{class:"box-item",effect:"light",content:t.$t("tips.lockNormal"),placement:"bottom"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{class:"ML-5"},{default:(0,s.w5)((()=>[(0,s.Wm)($)])),_:1})])),_:1},8,["content"])])),_:1})])),_:1},8,["modelValue"])])]),0==l.lockType?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",T,[(0,s._)("div",x,[(0,s._)("span",null,(0,o.zw)(l.t("lock.lineReleaseDay")),1),(0,s.wy)((0,s._)("input",{class:"buy-item__input flex-1","onUpdate:modelValue":e[9]||(e[9]=t=>l.releaseDays=t)},null,512),[[r.nr,l.releaseDays]])])]),(0,s._)("div",z,[(0,s._)("div",A,[(0,s._)("span",null,(0,o.zw)(l.t("lock.lineReleaseAmount")),1),(0,s.wy)((0,s._)("input",{class:"buy-item__input flex-1","onUpdate:modelValue":e[10]||(e[10]=t=>l.releaseAmount=t)},null,512),[[r.nr,l.releaseAmount]])])]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.releaseList,(t=>((0,s.wg)(),(0,s.j4)(O,{class:"tools-slippage__select-tag ML-5",type:"success",effect:l.buyCase==t?"dark":"light",onClick:e=>n.setRelease(t),key:t},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(t)+"% ",1)])),_:2},1032,["effect","onClick"])))),128)),(0,s.Wm)(O,{class:"tools-slippage__select-tag ML-5",type:"success",effect:"div"==l.buyCase?"dark":"light",onClick:e[11]||(e[11]=t=>n.setRelease("div"))},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("div")),1)])),_:1},8,["effect"])],64)):(0,s.kq)("",!0),(0,s._)("div",M,[(0,s._)("div",S,[(0,s._)("span",null,(0,o.zw)(l.t("lock.day")),1),(0,s.wy)((0,s._)("input",{class:"buy-item__input flex-1","onUpdate:modelValue":e[12]||(e[12]=t=>l.lockDay=t)},null,512),[[r.nr,l.lockDay]])])])])]),l.isLogin?0==n.getPrices("item1")?((0,s.wg)(),(0,s.j4)(j,{key:1,disabled:"",class:"trade-btn"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("pleaseEnter")+l.t("amount")),1)])),_:1})):l.hasApprove?((0,s.wg)(),(0,s.iD)(s.HY,{key:3},[n.getAmount()?((0,s.wg)(),(0,s.j4)(j,{key:0,class:"trade-btn",loading:l.swapLoading,onClick:n.swapSubmit},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("lock.lock")),1)])),_:1},8,["loading","onClick"])):((0,s.wg)(),(0,s.j4)(j,{key:1,disabled:"",class:"trade-btn"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("balance")+l.t("notEnough")),1)])),_:1}))],64)):((0,s.wg)(),(0,s.j4)(j,{key:2,loading:l.approveLoading,class:"trade-btn",onClick:n.approveHandler},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("approve")),1)])),_:1},8,["loading","onClick"])):((0,s.wg)(),(0,s.j4)(j,{key:0,class:"trade-btn",onClick:n.loginFn},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("connect")+l.t("wallet")),1)])),_:1},8,["onClick"]))])]),(0,s.Wm)(q,{ref:"tokens",onChange:n.tokenChange,onUpdate:n.tokenUpdate},null,8,["onChange","onUpdate"]),(0,s.Wm)(V,{ref:"swapConfirm",confirm:n.swapHandler,amountOutMin:l.gotPrice(l.utils.formatUnits(n.amountOutMin.toString(),l.item2.decimals))},null,8,["confirm","amountOutMin"]),(0,s.Wm)(F,{ref:"history"},null,512),(0,s.Wm)(Y,{ref:"rpcList"},null,512),(0,s.Wm)(G,{ref:"setting"},null,512),((0,s.wg)(),(0,s.j4)(s.Ob,null,[(0,s.Wm)(E,{ref:"pkm",onUpdate:t.pkmUpdate},null,8,["onUpdate"])],1024))],64)}]]);const G=t=>((0,s.dD)("data-v-32476490"),t=t(),(0,s.Cn)(),t),E={class:"trade"},Q={class:"trade-info PB-20",style:{width:"500px"}},K={class:"trade-top"},X={class:"trade-info__title MB-10"},tt={class:"trade-info__title-info"},et={class:"trade-item"},it={class:"trade-item__top trade-item__input flex-row-between"},st={class:"flex-row-start align-center pointer"},at={class:"trade-item__top-icon MR-10"},lt={class:"trade-item__top-name text-overflow__1"},nt={class:"filter-view"},ot={class:"title-text"},rt=G((()=>(0,s._)("span",{class:"arrow"},null,-1))),ct={class:"flex-row-start align-center"},dt={class:"text-price text-18 text-start"},mt={class:"flex-row-start align-center"},ht={class:"text-price text-18 text-start"},pt={class:"filter-content"},ut={class:"skill-list"},gt={class:"skill-item"},wt={class:"flex-row-start align-center"},kt={class:"text-price text-start"},ft={class:"text-price text-end"},yt=["onClick"],_t={class:"flex-row-start align-center"},vt={class:"text-price text-start"},Ct={class:"text-price text-end"},bt={class:"flex-row-start align-center"},Lt={class:"text-price text-start"},Tt={class:"text-price text-end"},xt={class:"flex-row-start align-center"},zt={class:"text-price text-start"},At={class:"text-price text-end"},Mt={class:"flex-row-start align-center"},St={class:"text-price text-start"},Dt={class:"text-price text-end"},Wt={class:"sub-filter-item"},Nt={class:"text-inner"},Ut={class:"sub-filter-item"},Pt={class:"text-inner"},Ht={class:"sub-filter-item"},Rt={class:"buy-item flex-row-start align-center MR-10 MB-10",style:{width:"100%"}},Bt={class:"text-inner"},Ot={class:"PL-15 PR-15"},$t={class:"flex-row-between"},It={class:"skill-list"},Jt={class:"skill-item"},Zt={class:"s-title"},jt={class:"info"},qt={class:"title-name",style:{color:"rgb(129, 226, 62)"}},Vt=G((()=>(0,s._)("div",{class:"stars-widget stars-small"},null,-1))),Ft={class:"brief"},Yt=G((()=>(0,s._)("p",{class:"PT-15"},null,-1))),Gt={class:"buy-item flex-row-start align-center MR-10 MB-10",style:{width:"100%"}};const{t:Et}=Z.default.global;var Qt={data(){return{t:Et,checkLowerCase:W.YG,utils:O,lockContract:"",contracts:"",gotPrice:W.ph,getLogo:W.R7,getBit:W.qD,callTime:0,payableAmount:void 0,lockList:[],scanPair:!1,isLogin:!1,lockType:0,releaseAmount:0,releaseDays:0,lockDay:0,nowTime:0,inputTimeout:null,loginTimeout:null,isRefreshing:!1,loading:!1,approveLoading:!1,progress:1,buyCase:10,releaseList:[10,20,30,50],gWeiList:[3,6,9,12],hasApprove:!1,type:"",item1:{},selectToekn:{},item2:{}}},components:{Tokens:N.Z,History:H.Z,RpcList:U.Z,Setting:P.Z},computed:{...(0,J.Se)(["currentNetwork","currentConfig","accountChange","connectState"]),amountOutMin(){if(!this.item2.price)return $.O$.from(0);let t=I.vz(this.item2.price.toString(),this.item2.decimals),e=I.vz(this.item2.price.toString(),this.item2.decimals),i=I.vz(this.progress.toString(),this.item2.decimals),s=I.vz("100",this.item2.decimals);return e.sub(t.mul(i).div(s)).toString()}},activated(){let t=localStorage.getItem("progress");this.progress=t?JSON.parse(t):1,this.isRefreshing=!0,this.lockContract=this.currentNetwork.lockContract,this.CallContract=new D.Z.Call({blockchain:this.currentNetwork.chains,type:"lock",address:this.lockContract}),this.CallContract.getParams("checkTxPrice").then((t=>{this.payableAmount=t})),this.CallContract.getParams("checkNowTime").then((t=>{this.nowTime=t})),this.handleAccount()},deactivated(){this.isRefreshing=!1,clearTimeout(this.callTime)},watch:{accountChange:{handler(t,e){this.handleAccount()},deep:!0},"currentNetwork.ChainID":{immediate:!0,handler(){const{Token:t}=this.currentNetwork,e=t[0];this.item1={...this.item1,...e}}}},mounted(){this.$watch("$route.params.key",(t=>{this.loginCallBack()}))},methods:{...(0,J.nv)(["setConnectDialog"]),handleAccount(){let t=this.getAccount();this.hasApprove=!1,this.pathHas=[],this.item1.price="",t?(this.isLogin=!0,this.loginCallBack()):this.isLogin=!1},openAddr(t){window.open(this.currentNetwork.Explorer[0]+`/address/${t}`)},getTime(t){t*=1e3;let e=new Date(t);return(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()+" ")+(e.getHours()+":")+e.getMinutes()},async unlockClaim(t){this.loading=!0,this.loading=!1},async addLockTime(t){},async selectPair(){this.scanPair=!0;try{let t=await this.CallContract.getParams("getLockLength",[this.item1.address]);this.lockList=[];const e=Math.ceil(t/10),i=Array.from({length:e},((t,e)=>this.CallContract.getParams("getLockList",[this.item1.address,10*e,10]))),s=await Promise.all(i);let a=this.getAccount(),l=s.flat();l=l.filter((t=>"0x0000000000000000000000000000000000000000"!==t.owner)),this.lockList=l.filter((t=>this.checkLowerCase(t.owner,a)));let n=await window.wallet.getByToken(this.item1.address);this.selectToekn=n}catch(t){}this.scanPair=!1},async findPair(){this.scanPair=!0,this.lockList=[];try{let t=await this.CallContract.getParams("lockOwner",[this.contracts]),e=await window.wallet.getByToken(t.token,this.contracts);this.selectToekn=e,this.lockList=[t]}catch(t){}this.scanPair=!1},getShortAddress(t){return t.slice(0,6)+"..."+t.slice(-4)},async price1Change(t,e=!1){if(clearTimeout(this.inputTimeout),!this.getPrices(t))return;this.inputTimeout=setTimeout((async()=>{await this.checkApprove(),this.setRelease(this.buyCase)}),350)},setRelease(t){this.buyCase=t,this.releaseAmount=I.bM(I.vz(this.item1.price,this.item1.decimals).mul(t).div(100),this.item1.decimals)},filterClick(t){t.currentTarget.parentElement.className.includes("filter-item")&&(t.currentTarget.parentElement.className="filter-item add"==t.currentTarget.parentElement.className?"filter-item add item-hidden":"filter-item add")},getPrices(t){if(void 0===this[t].price||""==this[t].price.trim())return this[t].price="",!1;let e=this[t].price.toString();const i=I.vz("0",18);let s=I.vz(e,this[t].decimals);return!s.lte(i)&&s},getAmount(){var t=this.item1;return""==t.price||!t.balance||(!t.balance.gte||t.balance.gte(I.vz(t.price,t.decimals)))},getAccount(){let t=window.wallet.getByAccount();return t?.address},openSetting(){this.$refs.setting.open()},openRpcList(){this.$refs.rpcList.open()},refreshPage(t){this.type="item2",this.$refs.tokens.fastImport(t.address,!1)},addTokenHandler(){const{symbol:t,address:e}=this.item2;window.wallet.addTokenToMeta(e,t,(0,W.R7)(e))},progressChange(){localStorage.setItem("progress",this.progress)},tokenUpdate({address:t,name:e,symbol:i}){this.item1.address==t&&(this.item1.name=e,this.item1.symbol=i),this.isLogin&&this.loginCallBack()},async tokenChange(t,e){"item1"==(e=e||this.type)?this.item2.address==t.address&&(this.item2=JSON.parse(JSON.stringify(this.item1))):this.item1.address==t.address&&this.item1.address==t.address&&(this.item1=JSON.parse(JSON.stringify(this.item2))),t.price="0",this[e]=t,this.isLogin&&this.loginCallBack(),this.selectPair()},maxHandler(){let t=(0,j.IU)(this.item1.balance);if(this.checkLowerCase(this.item1.address,window.wallet.getWrappedAddress())){const e=I.vz("0.001",this.item1.decimals);t=t.sub(e)}this.item1.price=(0,W.qD)(I.bM(t,this.item1.decimals)),this.price1Change("item1",!0)},async approveHandler(){this.approveLoading=!0;try{let t,e=this.getAccount(),i=await window.wallet.getByToken(this.item1.address,e),s=$.O$.from("115792089237316195423570985008687907853269984665640564039457584007913129639935",0);try{t=await i.token.approve(this.lockContract,s),(0,B.bM)({type:Et("success"),title:Et("success"),message:Et("exchange")+Et("success")}),await this.swapHandler()}catch(e){this.$refs.history.pushItem({item1:JSON.parse(JSON.stringify(this.item1)),action:"approve",tx:JSON.parse(JSON.stringify(t)),status:0}),(0,B.bM)({title:"提示 swapHistory",message:e.message,type:"error",duration:3e3})}this.checkApprove()}catch(t){(0,W.CR)(t)}this.approveLoading=!1},async loginCallBack(t=!0){clearTimeout(this.loginTimeout);this.loginTimeout=setTimeout((async()=>{this.item1.loading=t,this.item2.loading=t,await this.getItemBalance(this.item1.address,"item1")}),500)},async getItemBalance(t,e){if(!t)return!1;if(!this.isLogin)return!1;let{name:i,symbol:s,decimals:a,balance:l}=await window.wallet.getByToken(t);return this[e].balance=l,this[e].decimals=a,this[e].name=i,this[e].symbol=s,this[e].loading=!1,{balance:l,decimals:a}},copyHandler(t){(0,R.Z)(t),(0,B.bM)({type:Et("success"),title:Et("success"),message:Et("copy")+Et("success")})},toggleGwei(t){this.gWei=t,window.wallet.setGasGwei(t)},openHistory(){this.$refs.history.open()},openTokensDialog(t){this.type=t,this.$refs.tokens.open([this.item1.address,this.item2.address])},swapSubmit(){this.currentConfig?.professional?this.swapHandler():this.$refs.swapConfirm.open(this.item1,this.item2)},loginFn(){this.setConnectDialog(!0)}}};var Kt={data(){return{activeName:"created"}},computed:{},components:{tempCreated:Y,tempFind:(0,F.Z)(Qt,[["render",function(t,e,i,a,l,n){const c=(0,s.up)("ArrowDown"),d=(0,s.up)("el-icon"),m=(0,s.up)("CopyDocument"),h=(0,s.up)("el-button"),p=(0,s.up)("Tokens"),u=(0,s.Q2)("lazy");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",E,[(0,s._)("div",Q,[(0,s._)("div",K,[(0,s._)("div",X,(0,o.zw)(l.t("lock.title")+l.t("lock.manage")),1),(0,s._)("div",tt,(0,o.zw)(l.t("lock.queryLockInfo")),1)]),(0,s._)("div",et,[(0,s._)("div",it,[(0,s._)("div",st,[(0,s._)("div",{class:"flex-row-start align-center",onClick:e[0]||(e[0]=t=>n.openTokensDialog("item1"))},[(0,s.wy)((0,s._)("img",at,null,512),[[u,l.getLogo(l.item1.address)]]),(0,s._)("div",lt,(0,o.zw)(l.item1.symbol),1),(0,s.Wm)(d,{class:"ML-5"},{default:(0,s.w5)((()=>[(0,s.Wm)(c)])),_:1})]),(0,s.Wm)(d,{class:"ML-5",onClick:e[1]||(e[1]=t=>n.copyHandler(l.item1.address))},{default:(0,s.w5)((()=>[(0,s.Wm)(m)])),_:1})])])]),(0,s._)("div",nt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(this.lockList,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.lockAddr,class:"filter-item add item-hidden"},[(0,s._)("div",{class:"filter-title",onClick:e[2]||(e[2]=t=>n.filterClick(t))},[(0,s._)("span",ot,(0,o.zw)(l.selectToekn.symbol),1),rt,(0,s._)("div",ct,[(0,s._)("div",dt,(0,o.zw)(l.t("lock.time"))+":"+(0,o.zw)(n.getTime(l.utils.formatUnits(t.lockTime,0)))+"/"+(0,o.zw)(l.t("lock.day"))+":"+(0,o.zw)(l.utils.formatUnits(t.lockDay,0)),1)]),(0,s._)("div",mt,[(0,s._)("div",ht,(0,o.zw)(l.t("lock.amount"))+":"+(0,o.zw)(l.utils.formatUnits(t.balance,l.selectToekn.decimals)),1)])]),(0,s._)("div",pt,[(0,s._)("div",ut,[(0,s._)("div",gt,[(0,s._)("div",wt,[(0,s._)("div",kt,(0,o.zw)(l.t("lock.contracts"))+" : ",1),(0,s._)("div",ft,[(0,s._)("a",{onClick:e=>n.openAddr(t.lockAddr)},(0,o.zw)(n.getShortAddress(t.lockAddr)),9,yt)])]),(0,s._)("div",_t,[(0,s._)("div",vt,(0,o.zw)(l.t("owner"))+": ",1),(0,s._)("div",Ct,[(0,s.Uk)((0,o.zw)(n.getShortAddress(t.owner))+" ",1),(0,s.Wm)(d,{class:"ML-5",onClick:e=>n.copyHandler(t.owner)},{default:(0,s.w5)((()=>[(0,s.Wm)(m)])),_:2},1032,["onClick"])])]),t.isLine?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",bt,[(0,s._)("div",Lt,(0,o.zw)(l.t("lock.lineRelease"))+" : ",1),(0,s._)("div",Tt,(0,o.zw)(l.utils.formatUnits(t.releaseAmount,l.selectToekn.decimals)),1)]),(0,s._)("div",xt,[(0,s._)("div",zt,(0,o.zw)(l.t("lock.lineReleaseDay"))+" : ",1),(0,s._)("div",At,(0,o.zw)(l.utils.formatUnits(t.releaseDays,0)),1)]),(0,s._)("div",Mt,[(0,s._)("div",St,(0,o.zw)(l.t("lock.lastClaim"))+": ",1),(0,s._)("div",Dt,(0,o.zw)(n.getTime(l.utils.formatUnits(t.lastClaim,0))),1)]),(0,s._)("div",Wt,[(0,s.Wm)(h,{loading:l.loading,disabled:t.lastClaim.add(t.releaseDays.mul(86400))>l.nowTime,onClick:e=>n.unlockClaim(t),class:"trade-btn"},{default:(0,s.w5)((()=>[(0,s._)("span",Nt,(0,o.zw)(l.t("lock.lineRelease")),1)])),_:2},1032,["loading","disabled","onClick"])])],64)):(0,s.kq)("",!0),(0,s._)("div",Ut,[(0,s.Wm)(h,{loading:l.loading,disabled:t.lockTime.add(t.lockDay.mul(86400))>l.nowTime,onClick:e=>n.unlockClaim(t),class:"trade-btn"},{default:(0,s.w5)((()=>[(0,s._)("span",Pt,(0,o.zw)(l.t("lock.unlock")),1)])),_:2},1032,["loading","disabled","onClick"])]),(0,s._)("div",Ht,[(0,s._)("div",Rt,[(0,s._)("span",null,(0,o.zw)(l.t("lock.day"))+":",1),(0,s.wy)((0,s._)("input",{class:"buy-item__input flex-1","onUpdate:modelValue":e[3]||(e[3]=t=>l.lockDay=t)},null,512),[[r.nr,l.lockDay]])]),(0,s.Wm)(h,{loading:l.loading,onClick:e=>n.addLockTime(t),class:"trade-btn"},{default:(0,s.w5)((()=>[(0,s._)("span",Bt,(0,o.zw)(l.t("lock.addTime")),1)])),_:2},1032,["loading","onClick"])])])])])])))),128))]),(0,s._)("div",Ot,[(0,s._)("div",$t,[(0,s._)("div",It,[(0,s._)("div",Jt,[(0,s._)("div",Zt,[(0,s._)("div",jt,[(0,s._)("div",qt,(0,o.zw)(l.t("tips.title")),1),Vt])]),(0,s._)("div",Ft,[(0,s._)("p",null,(0,o.zw)(l.t("lock.enterLockContractLookInfo")),1),Yt,(0,s._)("div",Gt,[(0,s._)("span",null,(0,o.zw)(l.t("lock.contracts"))+":",1),(0,s.wy)((0,s._)("input",{class:"buy-item__input flex-1","onUpdate:modelValue":e[4]||(e[4]=t=>l.contracts=t)},null,512),[[r.nr,l.contracts]])]),(0,s._)("p",null,[(0,s.Wm)(h,{onClick:n.findPair,class:"trade-btn MB-15",loading:l.scanPair},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(l.t("query")),1)])),_:1},8,["onClick","loading"])])])])])])])])]),(0,s.Wm)(p,{ref:"tokens",onChange:n.tokenChange,onUpdate:n.tokenUpdate},null,8,["onChange","onUpdate"])],64)}],["__scopeId","data-v-32476490"]])},beforeMount(){this.$route;this.activeName=this.$route.params.key},methods:{async tabChange(t,e){this.activeName=t.props.name,this.$router.push({path:"/lock/"+this.activeName})}}};var Xt=(0,F.Z)(Kt,[["render",function(t,e,i,a,o,r){const c=(0,s.up)("tempCreated"),d=(0,s.up)("el-tab-pane"),m=(0,s.up)("tempFind"),h=(0,s.up)("el-tabs");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",n,[(0,s.Wm)(h,{modelValue:o.activeName,"onUpdate:modelValue":e[0]||(e[0]=t=>o.activeName=t),class:"home",onTabClick:r.tabChange},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{label:t.t("lock.create"),name:"created"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(s.Ob,null,["created"===o.activeName?((0,s.wg)(),(0,s.j4)(c,{key:0,actModel:o.activeName,onFromChild:r.tabChange},null,8,["actModel","onFromChild"])):(0,s.kq)("",!0)],1024))])),_:1},8,["label"]),(0,s.Wm)(d,{label:t.t("lock.manage"),name:"scan"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(s.Ob,null,["scan"===o.activeName?((0,s.wg)(),(0,s.j4)(m,{key:0,actModel:o.activeName,onFromChild:r.tabChange},null,8,["actModel","onFromChild"])):(0,s.kq)("",!0)],1024))])),_:1},8,["label"])])),_:1},8,["modelValue","onTabClick"])])])}]]),te={data(){return{activeName:"lock",lock:Xt}},components:{elLock:Xt,elItem:a.Z},methods:{}};var ee=(0,F.Z)(te,[["render",function(t,e,i,a,l,n){const o=(0,s.up)("elItem");return(0,s.wg)(),(0,s.j4)(o,{lock:l.lock,activeName:l.activeName},null,8,["lock","activeName"])}]])}}]);